<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <!-- Animated Ironcliw Arc Reactor Favicon -->
  <link rel="icon" href="%PUBLIC_URL%/favicon.svg" type="image/svg+xml" />
  <link rel="alternate icon" href="%PUBLIC_URL%/favicon.ico" type="image/x-icon" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#000000" />
  <meta name="description" content="Ironcliw-AI - Inspired by Iron Man's J.A.R.V.I.S." />
  <link rel="apple-touch-icon" href="%PUBLIC_URL%/logo192.png" />
  <!--
      manifest.json provides metadata used when your web app is installed on a
      user's mobile device or desktop. See https://developers.google.com/web/fundamentals/web-app-manifest/
    -->
  <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />
  <!--
      Notice the use of %PUBLIC_URL% in the tags above.
      It will be replaced with the URL of the `public` folder during the build.
      Only files inside the `public` folder can be referenced from the HTML.

      Unlike "/favicon.ico" or "favicon.ico", "%PUBLIC_URL%/favicon.ico" will
      work correctly both with client-side routing and a non-root public URL.
      Learn how to configure a non-root public URL by running `npm run build`.
    -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600;700&family=Rajdhani:wght@400;600;700&display=swap"
    rel="stylesheet">
  <title>Ironcliw-AI Interface</title>
  <style>
    /* Prevent white flash during page load and transitions */
    html, body {
      background-color: #000000 !important;
      margin: 0;
      padding: 0;
    }

    /* Ensure smooth fade-in on initial load */
    #root {
      animation: fadeIn 0.5s ease-in;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
  </style>
</head>

<body>
  <noscript>You need to enable JavaScript to run this app.</noscript>
  <div id="root"></div>
  <!--
      This HTML file is a template.
      If you open it directly in the browser, you will see an empty page.

      You can add webfonts, meta tags, or analytics to this file.
      The build step will place the bundled scripts into the <body> tag.

      To begin the development, run `npm start` or `yarn start`.
      To create a production bundle, use `npm run build` or `yarn build`.
    -->
  <script src="/clear-stale-cache.js"></script>

  <!-- Global error handlers for Chrome extension conflicts and uncaught promises -->
  <script>
    // Handle uncaught promise rejections (e.g., from Chrome extensions)
    window.addEventListener('unhandledrejection', function(event) {
      // Check if it's a Chrome extension error (403, message port closed, etc.)
      const error = event.reason;

      if (error && (
        error.code === 403 ||
        error.message?.includes('message port') ||
        error.message?.includes('Extension context') ||
        error.httpError === false
      )) {
        // Silently ignore Chrome extension errors - they don't affect Ironcliw functionality
        console.debug('Chrome extension error suppressed:', error.message || error.code);
        event.preventDefault();
        return;
      }

      // Log other unhandled rejections for debugging
      console.error('Unhandled promise rejection:', error);
    });

    // Handle runtime errors from Chrome extensions
    window.addEventListener('error', function(event) {
      if (event.message?.includes('Extension context') ||
          event.message?.includes('message port')) {
        console.debug('Chrome extension error suppressed:', event.message);
        event.preventDefault();
        return;
      }
    });

    // Suppress Chrome extension lastError warnings
    if (typeof chrome !== 'undefined' && chrome.runtime) {
      const originalRuntime = chrome.runtime;
      Object.defineProperty(chrome, 'runtime', {
        get: function() {
          return new Proxy(originalRuntime, {
            get: function(target, prop) {
              if (prop === 'lastError') {
                // Access lastError to clear it, but don't throw
                const lastError = target[prop];
                if (lastError) {
                  console.debug('Chrome runtime.lastError suppressed:', lastError.message);
                }
                return undefined;
              }
              return target[prop];
            }
          });
        }
      });
    }
  </script>
  </body>

</html>